type User {
  id: ID! @id
  email: String @unique
  password: String!
  name: String!
  locations: [Location]! @relation(onDelete: CASCADE)
	createdAt: DateTime! @createdAt
  deletedAt: DateTime
}

type MenuItem {
  id: ID! @id
  title: String!
  description: String!
  price: Int!
  pictureURL: String!
  calories: Int!
  paymentProcessorId: String @unique
  preferences: [Preference!]! @scalarList(strategy: RELATION)
  location: Location @relation(link: INLINE onDelete: SET_NULL)
  menuItemToUpsell: MenuItem @relation(name: "MenuItemToUpsell")
  orders: [Order]! @relation(onDelete: CASCADE)
  options: [Option!] @relation(onDelete: CASCADE)
  transactions: [Transaction]! @relation(onDelete: CASCADE)
  categories: [MenuCategory]! @relation(link: TABLE)
  createdAt: DateTime! @createdAt
  deletedAt: DateTime
}

type Location {
	id: ID! @id
	address: String!
	phoneNumber: String!
	email: String
  name: String!
	owner: User! @relation(link: INLINE onDelete: SET_NULL)
  pictureURL: String!
  cloverMetaData: CloverMetaData @relation(onDelete: CASCADE)
  tabletDevices: [TabletDevice]! @relation(onDelete: CASCADE)
  menuItems: [MenuItem]! @relation(onDelete: CASCADE)
  menuCategories: [MenuCategory]! @relation(onDelete: CASCADE)
  taxes: [Tax]! @relation(onDelete: CASCADE)
  transactions: [Transaction]! @relation(onDelete: CASCADE)
  orders: [Order]! @relation(onDelete: CASCADE)
  createdAt: DateTime! @createdAt
  deletedAt: DateTime
}

type Order {
	id: ID! @id
	menuItem: MenuItem! @relation(link: INLINE onDelete: SET_NULL)
  options: [Option]!
	location: Location! @relation(link: INLINE onDelete: SET_NULL)
	status: MealStatus!
	createdAt: DateTime! @createdAt
  deletedAt: DateTime
}

type Transaction {
	id: ID! @id
	location: Location! @relation(link: INLINE onDelete: SET_NULL)
	menuItem: MenuItem! @relation(link: INLINE onDelete: SET_NULL)
	createdAt: DateTime! @createdAt
  deletedAt: DateTime
}

type MenuCategory {
	id: ID! @id
	owner: Location! @relation(link: INLINE onDelete: SET_NULL)
  menuItems: [MenuItem]! @relation(onDelete: CASCADE)
	name: String!
  paymentProcessorId: String @unique
	createdAt: DateTime! @createdAt
  deletedAt: DateTime
}


type Option {
  id: ID! @id
  menuItems: [MenuItem]! @relation(link: TABLE)
	title: String!
  maxSelections: Int!
  required: Boolean!
  priority: Int!
  paymentProcessorId: String @unique
  optionValues: [OptionValue!]! @relation(onDelete: CASCADE)
	createdAt: DateTime! @createdAt
  deletedAt: DateTime
}

type OptionValue {
  id: ID! @id
  option: Option! @relation(link: INLINE onDelete: SET_NULL)
  pictureURL: String
  title: String!
  price: Int!
  isDefault: Boolean!
  priority: Int!
  paymentProcessorId: String @unique
  createdAt: DateTime! @createdAt
  deletedAt: DateTime
}

type Tax {
  id: ID! @id
  paymentProcessorId: String @unique
  taxType: TaxType!
  taxAmount: Int!
  name: String!
  location: Location! @relation(link: INLINE onDelete: SET_NULL)
  createdAt: DateTime! @createdAt
  deletedAt: DateTime
}

type TabletDevice {
  id: ID! @id
  headerId: String!
  cloverPaymentDeviceId: String
  kitchenPrinter: KitchenPrinter 
  location: Location @relation(link: INLINE onDelete: SET_NULL)
  createdAt: DateTime! @createdAt
  deletedAt: DateTime
}

type KitchenPrinter {
	id: ID! @id
  type: KitchenPrinterType!
  tabletDevices: [TabletDevice]! @relation(link: TABLE)
	ipAddress: String!
  createdAt: DateTime! @createdAt
  deletedAt: DateTime
}

type CloverMetaData {
	id: ID! @id
  paymentProcessorMerchantId: ID!
  paymentProcessorAccessToken: String!
  locationa: [Location]! @relation(link: TABLE onDelete: SET_NULL)
  createdAt: DateTime! @createdAt
  deletedAt: DateTime
}

enum MealStatus {
  ORDERED
  PREPARING
  DONE
	CANCELLED
}

enum KitchenPrinterType {
  EPSON
  STAR
}

enum TaxType {
  PERCENT
  FLAT
}

enum PaymentProcessor {
	CLOVER
	SQUARE
}

enum Preference {
	VEGAN
	VEGETARIAN
  PEANUTFREE
}